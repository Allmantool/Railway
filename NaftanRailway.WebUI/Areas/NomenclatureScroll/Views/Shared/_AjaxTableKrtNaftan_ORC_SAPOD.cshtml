@using System.Web.Mvc.Html
@using NaftanRailway.Domain.Concrete.DbContext.ORC
@using NaftanRailway.WebUI.Areas.NomenclatureScroll.Models
@using NaftanRailway.WebUI.ViewModels
@model IEnumerable<krt_Naftan_orc_sapod>
@{
    PagingInfo pageInfo = ViewBag.PagingInfo;
<<<<<<< HEAD
    pageInfo.AjaxOptions = new AjaxOptions(){
        HttpMethod = "Get", 
        UpdateTargetId = "ScrollTable", 
        InsertionMode = InsertionMode.Replace, 
        OnSuccess = "filterMenu"
    };
    
=======
>>>>>>> 5a6dfbf73a7198e3ac3178486d5927a4a853fb17
    int numberScroll = ViewBag.nper;
    DateTime reportYear = ViewBag.date_obrabot;
}

<h3 class="text-center control-label">Перечень № @numberScroll<br/>
    <span class="small">(поступил в электронном виде из ОРЦ @reportYear.ToShortDateString() г. Общее кол-во записей: @pageInfo.TotalItems)</span><br/>
</h3>
<table id="DetailsTable" class="small table table-hover table-responsive table-striped table-condensed table-bordered">
    <thead class="tableHeader">
    <tr>
        <th class="text-center">Карточка<br/>(NKRT)<span class="glyphicon glyphicon-filter"></span></th>
        <th class="text-center">Тип<br/><span style ="white-space: nowrap">док.</span><span class="glyphicon glyphicon-filter"></span></th>
        <th class="text-center">Вид<br/><span style ="white-space: nowrap">сбора<span class="glyphicon glyphicon-filter"></span></span></th>
        <th class="text-center">DT</th>
        <th class="text-center">NOMOT</th>
        <th class="text-center">Сумма без НДС</th>
        <th class="text-center">Сумма НДС</th>
        <th class="text-center">Сумма</th>
        <th class="text-center">Ставка НДС</th>
        <th class="text-center">txt<br/>OРЦ</th>
        <th class="text-center">Наименование сбора</th>
        <th class="text-center">ID_ED<br/>ОРЦ</th>
        <th class="text-center">ID_ED<br/>САПОД</th>
        <th class="text-center">textm<br/>САПОД</th>
        <th class="text-center">date<br/>raskr</th>
        <th class="text-center">num_doc</th>
        <th class="text-center">kol</th>
        <th class="text-center">summa</th>
        <th class="text-center">nds</th>
    </tr>
    <!--Grid filter-->
    <tr class="filter-menu">
        <th colspan="19">
            @using (Ajax.BeginForm("ScrollDetails", "Scroll"
<<<<<<< HEAD
=======
                //,new RouteValueDictionary(){
                //    { "controller","Scroll"},{ "action", "ScrollDetails" },
                //    { "numberScroll",((int) ViewBag.nper).ToString() }, 
                //    { "reportYear", ((DateTime)ViewBag.DtBuhOtchet).Year.ToString() }, 
                //    { "page", "1" }}
>>>>>>> 5a6dfbf73a7198e3ac3178486d5927a4a853fb17
                ,new { controller = "Scroll", action = "ScrollDetails", numberScroll = ViewBag.nper, reportYear = ((DateTime)ViewBag.DtBuhOtchet).Year, page = 1 }
                ,new AjaxOptions(){
                    HttpMethod = "Post",
                    UpdateTargetId = "chargeOfList"
                },new { @class = "form-inline" })) {
                @Html.Hidden("numberScroll", numberScroll)
                @Html.Hidden("reportYear", reportYear.Year)
<<<<<<< HEAD
                <div id="filterForm" class="form-inline"> 
                     @{ Html.RenderPartial("_FilterMenu", (IEnumerable<CheckListFilterModel>)ViewBag.Filters);} 
                </div>
=======
                <span id="filterForm"> 
                    @{ Html.RenderPartial("_FilterMenu", (IEnumerable<CheckListFilterModel>)ViewBag.Filters);}
                </span>
>>>>>>> 5a6dfbf73a7198e3ac3178486d5927a4a853fb17
            <button type="submit" class="form-control btn btn-primary">Фильтр</button>
            }
        </th>
    </tr>
    </thead>
    <tbody class="text-center" id="chargeOfList">
        @{ Html.RenderPartial("_KrtNaftan_ORC_SAPODRows", @Model);}
    </tbody>
</table>
<div id="loadingInfiniteScroll" class="text-center" style="display: none">
    <img alt="Загрузка..." src='@Url.Content("~/Content/Images/Gear.gif")'>
</div>
<!--Ajax paging-->
<<<<<<< HEAD
@{ Html.RenderPartial("_AjaxPagging", pageInfo);}
=======
<div class="bottom-right pull-right">
    <ul class="pagination">
    @{for (int q = 1; q <= ViewBag.PagingInfo.TotalPages; q++) {
            <li class="@(q == ViewBag.PagingInfo.CurrentPage ? "active" : "")">
                @Ajax.RouteLink(q.ToString(),
                    new RouteValueDictionary() { { "page", q } },
                        new AjaxOptions() {
                            HttpMethod = "Get",
                            UpdateTargetId = "ScrollTable",
                            InsertionMode = InsertionMode.Replace,
                            OnSuccess = "filterMenu"
                        })
            </li>
      }
    }
    </ul>
</div>
>>>>>>> 5a6dfbf73a7198e3ac3178486d5927a4a853fb17
<!--Don't support in partioal view (this html helper alternative-->
@Html.Script(@<script type="text/javascript" src="~/Scripts/UI_user.js" defer></script>)

<!--Simple link pagging-->
@*@if(Request.UserAgent != null && Regex.IsMatch(Request.UserAgent,@"MSIE 7")){
<div class="bottom-right pull-right">
    @Html.PageLinks(pageInfo, 21, x => Url.RouteUrl("DetailsRoutesWithParams", 
        new RouteValueDictionary(){
            {"numberScroll",ViewBag.nper},
            {"reportYear",@ViewBag.DtBuhOtchet.Year},
            {"page", x}
        }))
</div>
}*@